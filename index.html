<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>홍원 테트리스 (Final)</title>
    <style>
        /* 1. CSS: 스타일 및 파스텔 톤 정의 */
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #36454F;
            margin: 0;
            font-family: 'Malgun Gothic', sans-serif;
            flex-direction: column;
        }

        #score {
            color: #E6E6FA;
            margin-bottom: 20px; 
            font-size: 2.2em;
            font-weight: bold;
            text-shadow: 2px 2px #483D8B;
        }

        #game-container {
            border: 8px solid #E0B0FF;
            background-color: #1a1a2e;
            display: inline-block;
        }

        #game-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-template-rows: repeat(20, 1fr);
            gap: 1px;
        }

        .cell {
            width: 30px;
            height: 30px;
            background-color: #111;
            box-sizing: border-box;
            border: 1px solid #000;
            
            /* 텍스트 중앙 정렬 */
            display: flex;
            justify-content: center;
            align-items: center;
            color: #222; 
            font-size: 0.7em;
            font-weight: bold;
        }

        /* 2. 파스텔 톤 블록 색상 클래스 */
        .T { background-color: #B57EDC; border: 1px solid #9370DB; }
        .L { background-color: #FFB7C5; border: 1px solid #FF9DBF; }
        .J { background-color: #ADD8E6; border: 1px solid #87CEEB; }
        .I { background-color: #AFEEEE; border: 1px solid #7FFFD4; }
        .O { background-color: #FFFF99; border: 1px solid #FFFF66; }
        .S { background-color: #98FB98; border: 1px solid #7CFC00; }
        .Z { background-color: #FFC0CB; border: 1px solid #FF69B4; }

        .controls {
            color: #E6E6FA;
            margin-top: 15px;
            font-size: 1em;
        }
    </style>
</head>
<body>

    <div id="score">점수: 0</div> 

    <div id="game-container">
        <div id="game-board">
            </div>
    </div>
    
    <div class="controls">
        <p>키보드: ←, → (이동), ↓ (빠른 하강), ↑ (회전)</p>
    </div>

    <script>
        // 3. JavaScript: 로직

        // 게임 설정
        const COLS = 10;
        const ROWS = 20;
        const boardElement = document.getElementById('game-board');
        const scoreElement = document.getElementById('score');

        // 게임 상태
        let board = Array(ROWS).fill(0).map(() => Array(COLS).fill(0));
        let cells = []; 
        let currentPiece;
        let currentX = 0;
        let currentY = 0;
        let score = 0;
        let gameInterval;
        let speed = 1500; // 난이도: 1.5초 (하향)

        // 테트로미노 정의 (블록 회전 로직을 위해 shape 배열을 직접 수정합니다)
        const TETROMINOES = [
            // S (0)
            { shape: [[0,1,1], [1,1,0], [0,0,0]], color: 'S' },
            // Z (1)
            { shape: [[1,1,0], [0,1,1], [0,0,0]], color: 'Z' },
            // J (2)
            { shape: [[1,0,0], [1,1,1], [0,0,0]], color: 'J' },
            // L (3)
            { shape: [[0,0,1], [1,1,1], [0,0,0]], color: 'L' },
            // I (4)
            { shape: [[0,0,0,0], [1,1,1,1], [0,0,0,0], [0,0,0,0]], color: 'I' },
            // O (5)
            { shape: [[1,1], [1,1]], color: 'O' },
            // T (6)
            { shape: [[0,1,0], [1,1,1], [0,0,0]], color: 'T' }
        ];

        // --- 초기화 및 상태 함수 ---

        function createBoard() {
            for (let r = 0; r < ROWS; r++) {
                cells[r] = [];
                for (let c = 0; c < COLS; c++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell';
                    boardElement.appendChild(cell);
                    cells[r][c] = cell;
                }
            }
        }
        
        function updateScore(linesCleared = 0) {
            score += linesCleared * 100; // 줄당 100점
            scoreElement.textContent = `점수: ${score}`;
        }

        function newPiece() {
            const randomIndex = Math.floor(Math.random() * TETROMINOES.length);
            // JSON.parse/stringify를 사용하여 깊은 복사 (회전을 위해 필요)
            currentPiece = JSON.parse(JSON.stringify(TETROMINOES[randomIndex]));
            currentX = Math.floor(COLS / 2) - Math.floor(currentPiece.shape[0].length / 2);
            currentY = 0;

            if (!isValidMove(currentPiece.shape, currentX, currentY)) {
                clearInterval(gameInterval);
                alert('Game Over!
